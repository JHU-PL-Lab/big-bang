# EXPECT-TYPEFAIL
# This program should type error because we are explicitly excluding
# non-contractive application from our implementation (since it isn't terribly
# useful and is fundamentally exponential in the worst case).

let rec build(n:int,f) =
  if n == 0 then f else
    f & build(n=n - 1,f=f)
in
(build(n=4,f=(fun a,b -> a+b)))(a=2,b=3)
